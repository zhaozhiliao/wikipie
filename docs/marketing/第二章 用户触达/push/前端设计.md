[[基于业务设计]]

## 消息的业务分类
消息通知是 App 中最常见的功能模块。在前端功能设计前，首先要进行业务分析，基于实际业务场景，进行通知规划。
根据消息的业务属性和对送达率的要求度，一般我们将消息内容分成两类。『通知消息』和『运营消息』。
- 通知消息：也叫触发消息，主要指适用于系统业务类的通知。此类通知，在提前规划好消息内容后，一旦用户满足一定条件，自动触发。比如，快递消息、支付成功消息、还款消息、资产过期提醒等。这类消息对用户来说重要程度高，属于特定业务流程下必要环节。
- 运营消息：也叫营销消息，此类通知一般多用于促进用户活跃，引导消费等方面。通过运营 push，推送促销活动，折扣低价商品等内容。推送量量级大，但重要程度相对较低。

消息分类的意义
对 push 进行分类主要有三方面的作用：
1.  由于各厂商对 push 做了类型划分，对不同类型的消息，在发送频次、发送量级上都有严格的限制。因此合理设计 push 类型，可以保证高优先级 push 通道不被占用，提升 push 整体到达率；
2.  push 的业务划分也有利于消息页面的功能布局和规划，将更高优先级的 push 进行展示，折叠次要消息；
3.  在消息免打扰中，可以引导用户做个性化消息接收设置，避免一刀切式关闭所有通知，降低用户体验。

## 消息通知栏
[[补充：消息通知栏截图]]
通知栏消息样式由系统定义，App 可以根据业务需求在系统规则下进行样式设计。由于系统不同以及版本差异实际略有不同，建议此处参考各推送平台的后台和相关接口文档，了解其样式支持的机型以评估覆盖度。

总体来说，样式主要分成两类
- 基本样式：即 iOS 和 Android 厂商都通用的样式规范；
    - 应用名：即 App 包名
    - 应用图标：Appicon
    - 通知栏标题：20 字以内为宜，含 emoji
    - 通知摘要：50 字以内为宜，含 emoji；一般情况下内容较多时，界面会截断，只展示两行；
    - 图片：最佳分辨率为 876 * 324，支持 jpg，png 格式
    - 声音：即消息到达时声音，一般为系统默认音。

- 自定义样式：Android 厂商系统支持更多样式的消息展示，示例如下，详细可参考各厂商官网文档说明。
    - 华为：进度类通知和媒体类通知支持展示更多样式，如进度条、百分比、操作按钮等，详见 [《华为通知管理规范》](https://developer.huawei.com/consumer/cn/doc/development/HMSCore-Guides/notificattion_spec-0000001052845223#section82221538151117)
    - 小米：MIUI10 以上，同一个 App 的所有通知栏消息会聚合成一个消息组，消息组最多支持展示 10 条消息，超过 10 条消息，会自动删除一条最老的消息并补上来一条新消息。针对每条消息，开发者也可以单独定义是否响铃、是否振动、是否点亮呼吸灯。
    - 从 Android8.0（API ≥ 26）开始，Android 要求开发者必须为所有的通知分配通道，不同类的消息走不同的通道发送。 用户可关闭单个通道的消息通知， 不会影响其它通道的消息推送。 以下图为例：将通知分成了 4 种 Channel，3 个 Channel Group。
    - Channel 为实际的通知类别。Channel Group 为一组 channel，仅用于做分组区分，开发者可视自己的业务需求而定。每个通知类别的权限互相独立，互不影响。 [《OPPO 推送服务介绍》](https://open.oppomobile.com/wiki/doc#id=10742)

## 通知按钮
通知入口即用户消息查看入口，一般形态为铃铛样式，右下角标记是否有未读消息。用户可点击此按钮进入消息中心，查看消息内容。通知按钮主要考虑一点：未读消息要不要在按钮上做提示，以及如何提示。
[[补充：三类铃铛提示图片]]

是否要做提示，主要考虑消息的作用场景，即消息是否重要，需要用户非读不可。其次也要考虑中心页承载的功能场景和日常消息频次。

- **不做提示**：如果消息中心页只聚合 push 相关消息，起收纳留存作用，消息重要程度低，时效性不高，可以不做提示，以免打断用户使用流程。

- **做提示**：越来越多的消息页面不仅承担促销消息，还聚合了业务消息甚至客服、店铺消息。在实时沟通场景下，相应提示还是需要且必要的。
    - 红点提示：无论消息多少，简单用红点提示，红点刷新也根据用户是否点击按钮，或阅读消息内容为准，相对体验较好。
    - 数字提示：具体展示未读消息数量，需要用户一条条点击点击阅读消息详情才能消除。此类体验虽然较差，但客服 im 沟通、店铺沟通消息等对话消息，适用此种方式，以防用户错过重要消息。
    - 当选择提示标识，比如红点提示，还需要考虑红点消失策略。具体根据实际业务评估，大体也有两种选择
        - 点击按钮（进入页面）后，红点消失；
        - 红点关联消息，当所有消息都为已读状态（点击打开消息），红点消失。

从研发设计上，增加红点提示或展示数字提示，比不做提示成本要高，但作为产品经理，需要综合考虑消息提醒的必要性，以做出合理决策。

## 消息中心页
消息中心页是消息的聚合页面，也是 App 非常重要的功能模块。随着业务复杂化，越来越多的 App 消息通知页承担着多样化作用，因此基于业务规划消息页的功能模块成为页面设计的收益

### 功能模块规划
还是要根据场景做业务拆分，然后遵循同类消息合并原则，将消息进行聚合。以两个案例进行拆解：

以京东电商为例：
（这里补图）
根据业务需求，分成六类功能模块
- 交易物流：聚合订单、物流相关消息，如商品配货、出库、到货、订单完成、退货成功等交易流程中重要节点的消息通知。
- 账户通知：包含用户资产变动相关的通知，如积分、优惠券、金币等。
- 互动消息：评价、社区互动等内容的消息
这三类消息业务优先级高，因此固定头部展示。
- 优惠促销：运营促销相关消息，属于官方消息在列表页固定展示。
下面两类消息，根据消息的先后顺序在列表页依次排列展示。
- 官方号：可以理解为频道消息，通过建立多种频道（官方号），聚合同一频道下的消息内容。
- 店铺消息：店铺客服沟通消息
京东消息类型划分详细，且明确，布局合理，虽然消息内容多，但整体清晰，不混乱。

知乎社区
这里补图
仍然是根据社区业务需求优先级，将消息内容分成几种类型。
- 邀请回答：聚合所有邀请类消息
- 赞同与喜欢：所有回答互动消息
- 关注：所有关注消息
- 评论与转发：所有内容评论互动消息
- 私信：沟通消息

由上面两张图可以看出，即使在消息内页，也有相应的红点提示。一般情况下，按钮的红点提示和页内提示在逻辑上要保持一致。

红点的消失策略取决于是否需要引导用户点击进入三级页面。如果希望促进用户点击查看内容，则最好以数字标识。
比如，知乎用数字展示『喜欢赞同』数量和『评论转发』数量，很可能是由于这个页面没有展示出具体谁做了喜欢，喜欢了什么、谁做了评论，以及评论的内容是什么。所以需要引导用户进一步查看消息的详细内容，以增加互动内容曝光。[[待补充#可以进一步优化知乎的消息页面]]

### 需要注意的一些细节
因为营销消息较多，需要展示消息时间，可以按照以下规则进行提示：
- 当日消息：展示具体时间，如『19:30』
- 昨日消息：展示『昨日』
- 近七天消息：展示星期，如『星期四』
- 更久消息：展示具体消息日期，如『2021/11/15』

push 消息一般包含标题和内容，所以在列表展示时，尽量全的展示消息内容，提高可读性。

[[补充：push 需求文档]]

## 功能设置
用于引导用户主动设置消息的接受规则，以减少打扰，提高[[用户体验]]。一般主要从以下几个维度设置：
- 接收时段：仅在某一个时间范围内接收消息；
- 接收内容类型：仅接收某类消息通知，如订单消息、促销消息、中奖消息等；
- 消息主体：设置不接收某类消息、某人、某个频道消息。

## 授权页面
- push 滥发，许多用户习惯关闭 push 推送，因此需要设计授权开启 push 的触发机制。一般情况下可做弹窗引导和横幅。
- 弹窗内容中要写清楚开启 push 为用户带来的好处，或关闭 push 可能带来的风险，如积分过期损失等，增加设置转化；
- 横幅可固定于消息中心页，对关闭 push 的用户固定展示。

优秀的授权弹窗参考：
[[补充：通知授权弹窗图]]

push 相关的前端页面基本概括完整了，在实际业务中，要结合业务需求场景和技术能力，进行产品规划设计。
